### 变量

有一句著名的话：“如果你要做一件事情2次，写一个程序”。

因为我们可以通过程序将一件事情抽象化，这样做类似的事情的时候就可以直接修改数值，仍然执行那抽象化的指令就可以了。

这个时候我们不得不谈到一个概念：变量。

那么什么是变量？

变量就是初中数学的代数的概念，例如一个简单的方程，x，y都是变量：


$$
y=x^2+888
$$
也就是说，这个程序是将一个输入的变量x进行平方操作，然后加上888，无论输入的是1，2，3，还是8888，都可以进行这样平方后加上888的“抽象操作”。

这就是为什么变量能极大提升我们程序解决问题的能力。





在Java中，变量分为两种：基本类型的变量和引用类型的变量。

我们先来看看基本类型的变量。

在Java中，变量必须先定义后使用，在定义变量的时候，可以给它一个初始值。例如：

```java
int x = 888;
```

上述语句定义了一个整型`int`类型的变量，名称为`x`，初始值为`888`。

不写初始值，就相当于给它指定了默认值。默认值总是`0`。

来看一个完整的定义变量，然后打印变量值的例子：

```java
/**
 * 乐学偶得（lexueoude.com）原创笔记,公众号：乐学Fintech
 */
// 定义并打印变量
public class Main {
    public static void main(String[] args) {
        int x = 888; // 定义int类型变量x，并赋予初始值888
        System.out.println(x); // 打印该变量的值
    }
}

```

```java
888
```

变量的一个重要特点是可以重新赋值。例如，对变量`x`，先赋值`888`，再赋值`999`，观察两次打印的结果：

```java
/**
 * 乐学偶得（lexueoude.com）原创笔记,公众号：乐学Fintech
 */
// 重新赋值变量
public class Main {
    public static void main(String[] args) {
        int x = 888; // 定义int类型变量x，并赋予初始值888
        System.out.println(x); // 打印该变量的值，观察是否为888
        x = 999; // 重新赋值为999
        System.out.println(x); // 打印该变量的值，观察是否为999
    }
}
```



```java
888
999
```

注意到第一次定义变量`x`的时候，需要指定变量类型`int`，因此使用语句`int x = 888;`。而第二次重新赋值的时候，变量`x`已经存在了，不能再重复定义，因此不能指定变量类型`int`，必须使用语句`x = 999;`。

变量不但可以重新赋值，还可以赋值给其他变量。让我们来看一个例子：

```java
// 变量之间的赋值

public class Main {
    public static void main(String[] args) {
        int n = 888; // 定义变量n，同时赋值为888
        System.out.println("n = " + n); // 打印n的值

        n = 999; // 变量n赋值为999
        System.out.println("n = " + n); // 打印n的值

        int x = n; // 变量x赋值为n（n的值为999，因此赋值后x的值也是999）
        System.out.println("x = " + x); // 打印x的值

        x = x + 100; // 变量x赋值为x+100（x的值为999，因此赋值后x的值是999+100=1099）
        System.out.println("x = " + x); // 打印x的值
        System.out.println("n = " + n); // 再次打印n的值，n应该是999还是1099？
   }
}
```



```java
n = 888
n = 999
x = 999
x = 1099
n = 999
```

我们一行一行地分析代码执行流程：

执行`int n = 888;`，该语句定义了变量`n`，同时赋值为`888`，因此，JVM在内存中为变量`n`分配一个“存储单元”，填入值`888`：

```ascii
      n
      │
      ▼
┌───┬───┬───┬───┬───┬───┬───┐
│   │888│   │   │   │   │   │
└───┴───┴───┴───┴───┴───┴───┘
```

执行`n = 999;`时，JVM把`999`写入变量`n`的存储单元，因此，原有的值被覆盖，现在`n`的值为`999`：

```ascii
      n
      │
      ▼
┌───┬───┬───┬───┬───┬───┬───┐
│   │999│   │   │   │   │   │
└───┴───┴───┴───┴───┴───┴───┘
```

执行`int x = n;`时，定义了一个新的变量`x`，同时对`x`赋值，因此，JVM需要*新分配*一个存储单元给变量`x`，并写入和变量`n`一样的值，结果是变量`x`的值也变为`999`：

```ascii
      n           x
      │           │
      ▼           ▼
┌───┬───┬───┬───┬───┬───┬───┐
│   │999│   │   │999│   │   │
└───┴───┴───┴───┴───┴───┴───┘
```

执行`x = x + 100;`时，JVM首先计算等式右边的值`x + 100`，结果为`1099`（因为此刻`x`的值为`999`），然后，将结果`1099`写入`x`的存储单元，因此，变量`x`最终的值变为`1099`：

```ascii
      n           x
      │           │
      ▼           ▼
┌───┬───┬───┬───┬────┬───┬───┐
│   │999│   │   │1099│   │   │
└───┴───┴───┴───┴────┴───┴───┘
```

可见，变量可以反复赋值。这里我们需要注意的是，等号`=`是赋值语句，不是数学意义上的相等，

也就是说，当我们写`x = x + 100`的时候，并不是说x等于x+100，而是说将原有的x先加上100，然后将x重新赋值为加上100后的值。



### 基本数据类型

基本数据类型是CPU可以直接进行运算的类型。Java定义了以下几种基本数据类型：

- 整数类型：byte，short，int，long
- 浮点数类型：float，double
- 字符类型：char
- 布尔类型：boolean

Java定义的这些基本数据类型有什么区别呢？要了解这些区别，我们就必须简单了解一下计算机内存的基本结构。

计算机内存的最小存储单元是字节（byte），一个字节就是一个8位二进制数，即8个bit。它的二进制表示范围从`00000000`~`11111111`，换算成十进制是0~255，换算成十六进制是`00`~`ff`。

内存单元从0开始编号，称为内存地址。每个内存单元可以看作一间房间，内存地址就是门牌号。

```ascii
  0   1   2   3   4   5   6  ...
┌───┬───┬───┬───┬───┬───┬───┐
│   │   │   │   │   │   │   │...
└───┴───┴───┴───┴───┴───┴───┘
```

一个字节是1byte，1024字节是1K，1024K是1M，1024M是1G，1024G是1T。一个拥有4T内存的计算机的字节数量就是：

```
4T = 4 x 1024G
   = 4 x 1024 x 1024M
   = 4 x 1024 x 1024 x 1024K
   = 4 x 1024 x 1024 x 1024 x 1024
   = 4398046511104
```

不同的数据类型占用的字节数不一样。我们看一下Java基本数据类型占用的字节数：

```ascii
       ┌───┐
  byte │   │
       └───┘
       ┌───┬───┐
 short │   │   │
       └───┴───┘
       ┌───┬───┬───┬───┐
   int │   │   │   │   │
       └───┴───┴───┴───┘
       ┌───┬───┬───┬───┬───┬───┬───┬───┐
  long │   │   │   │   │   │   │   │   │
       └───┴───┴───┴───┴───┴───┴───┴───┘
       ┌───┬───┬───┬───┐
 float │   │   │   │   │
       └───┴───┴───┴───┘
       ┌───┬───┬───┬───┬───┬───┬───┬───┐
double │   │   │   │   │   │   │   │   │
       └───┴───┴───┴───┴───┴───┴───┴───┘
       ┌───┬───┐
  char │   │   │
       └───┴───┘
```

一个`byte`恰好就是一个字节，一个`long`或者是一个`double`需要8个字节。

### 整型

对于整型类型，Java只定义了带符号的整型，因此，最高位的bit表示符号位（0表示正数，1表示负数）。各种整型能表示的最大范围如下：

- byte：-128 ~ 127
- short: -32768 ~ 32767
- int: -2147483648 ~ 2147483647
- long: -9223372036854775808 ~ 9223372036854775807

我们来看定义整型的例子：

```java
public class Main {
    public static void main(String[] args) {
        int i = 123456789;
        int i2 = -1234567898;
        int i3 = 1_000_000_000; // 加下划线更容易识别
        int i4 = 0xff0002; // 十六进制表示的16711682
        int i5 = 0b10000000; // 二进制表示的128
        long l = 8888888888888888888L; // long型的结尾需要加L
        System.out.println(i);
        System.out.println(i2);
        System.out.println(i3);
        System.out.println(i4);
        System.out.println(i5);
        System.out.println(l);

    }
}

```

```java
123456789
-1234567898
1000000000
16711682
128
8888888888888888888
```

### 浮点型

浮点类型其实说起来文绉绉的，我们可以直接把浮点型简单理解成就是小数。

如果我们用科学计数法表示小数，小数点是可以“浮动”的，如1234.5可以表示成12.345x10^2，也可以表示成1.2345x10^3，所以称为浮点数。

下面是定义浮点数的例子：

```java
float f1 = 3.14f;
float f2 = 3.14e38f; // 科学计数法表示的3.14x10^38
double d = 1.79e308;
double d2 = -1.79e308;
double d3 = 4.9e-324; // 科学计数法表示的4.9x10^-324
```

对于`float`类型，需要加上`f`后缀。

浮点数可表示的范围非常大，`float`类型可最大表示3.4x10^38，而`double`类型可最大表示1.79x10^308。

### 布尔类型

布尔类型`boolean`只有`true`和`false`两个值，布尔类型总是关系运算的计算结果：

```java
boolean b1 = true;
boolean b2 = false;
boolean isGreater = 6 > 3; // 这段代码相当于比较6 是否比3 更大，计算结果为true，
int age = 12;
boolean isAdult = age >= 18; // 这段代码相当于比较12 是否比18 更大计算结果为false
```

Java语言对布尔类型的存储并没有做规定，因为理论上存储布尔类型只需要1 bit（我们可以思考一下为什么？——因为对与错不就是0和1就能表示吗？所以理论上只需要1bit就可以了），但是通常JVM内部会把`boolean`表示为4字节整数。

### 字符类型

字符类型`char`表示一个字符。Java的`char`类型除了可表示标准的ASCII外，还可以表示一个Unicode字符：

```java
public class Main {
    public static void main(String[] args) {
        char ascii = 'A';//注意char一定一定是单引号，很多其他语言转过来的小伙伴不习惯
        char unicode_zh = '乐'; //中文的一个字其实在英文中就叫做一个character~简写就是char咯~
        System.out.println(ascii);
        System.out.println(unicode_zh);
    }
}

```



注意`char`类型使用单引号`'`，且仅有一个字符，要和双引号`"`的字符串类型区分开。

### 引用类型

除了上述基本类型的变量，剩下的都是引用类型。例如，引用类型最常用的就是`String`字符串：

```
String s = "hello";
```

引用类型的变量类似于C语言的指针，它内部存储一个“地址”，指向某个对象在内存的位置

### 常量

定义变量的时候，如果加上`final`修饰符，这个变量就变成了常量, 常量的作用是用有意义的变量名来避免魔术数字（Magic number），例如，我们看下一段代码，假设我们需要计算圆的面积，因为涉及到PI，PI是3.141592653.......，但是因为接下去的代码可能要多次用到PI，我们为了避免在代码中到处写`3.14`，我们可以在开头定义一个常量。如果将来需要提高计算精度，我们只需要在常量的定义处修改，例如，改成`3.141592653`，而不必在所有地方替换`3.14`。

根据习惯，常量名通常全部大写。：

```java
final double PI = 3.141592653; // PI是一个常量
double r = 8.0;
double area = PI * r * r;
PI = 300; // 常量在定义时进行初始化后就不可再次赋值，再次赋值会导致编译错误。
```





### var关键字

有些时候，类型的名字太长，写起来比较麻烦。例如：

```java
StringBuilder sb = new StringBuilder(); //这是一种常见写法，我们真的会在代码中命名sb这样的变量
```

但是，大家可能会觉得这种赋值方式有点啰嗦——因为明明StringBuilder()已经暗含了是StringBuilder的类型，我们能否把代码进行简化呢？如果想省略变量类型，可以使用`var`关键字：

```java
var sb = new StringBuilder();
```

编译器会根据赋值语句自动推断出变量`sb`的类型是`StringBuilder`。对编译器来说，语句：

```java
var sb = new StringBuilder();
```

实际上会自动变成：

```java
StringBuilder sb = new StringBuilder();
```

因此，使用`var`定义变量，仅仅是少写了变量类型而已。

### 变量的作用范围

在Java中，多行语句用{ }括起来。很多控制语句，例如条件判断和循环，都以{ }作为它们自身的范围，例如：

```java
if (这里是判断的条件) { // 这里是if的开始
    这里是执行的一系列语句
    while (这里是判断的条件) { 这里是while 开始
        这里是执行的一系列语句
        if (这里是判断的条件) { // 这里是if开始
             这里是执行的一系列语句
        } // 这里是if结束
         这里是执行的一系列语句
    } // 这里是while结束
    这里是执行的一系列语句
} // 这里是if结束
```

只要正确地嵌套这些{ }，编译器就能识别出语句块的开始和结束。



我们还有一个需要注意的一点是，在每一个{}语句块中定义的变量，都有一个作用域——从变量的定义处开始，到语句块结束，这一部分都是变量的作用域。超出了作用域引用这些变量，编译器会报错。举个例子：

```java
{
    ...
    int i = 0; // 变量i从这里开始定义
    ...
    {
        ...
        int x = 1; // 变量x从这里开始定义
        ...
        {
            ...
            String s = "乐学偶得官网：lexueoude.com"; // 变量s从这里开始定义
            ...
        } // 变量s作用域到此结束
        ...
        // 注意，这是一个新的变量s，它和上面的变量同名，
        // 但是因为作用域不同，它们是两个不同的变量:
        String s = "公众号：乐学Fintech";
        ...
    } // 变量x和s作用域到此结束
    ...
} // 变量i作用域到此结束
```



虽然按照上面的栗子，我们可以无限制的不断定义一层包一层的作用域，但是我们还是需要在定义变量时，注意遵循作用域最小化原则，尽量将变量定义在尽可能小的作用域。 另外，虽然同样的变量名在不同作用域是可以储存不同的信息，我们还是尽量不要重复使用相同的变量名。



### 小结

Java提供了两种变量类型：基本类型和引用类型

基本类型包括整型，浮点型，布尔型，字符型。

变量可重新赋值，等号是赋值语句，不是数学意义的等号。

常量在初始化后不可重新赋值，使用常量便于理解程序意图，避免魔法数字。